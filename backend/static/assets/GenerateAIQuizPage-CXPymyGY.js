import{r as i,j as e,S as v,a as S}from"./index-BxF1agQl.js";const Q=({onQuizCreated:k,onCancel:j,userTier:z="free"})=>{const[o,q]=i.useState(""),[n,c]=i.useState(""),[d,N]=i.useState(""),[r,x]=i.useState("text"),[m,w]=i.useState(5),[b,h]=i.useState(!1),[p,u]=i.useState(""),[g,f]=i.useState(!1),y=async t=>{f(!0),u("");try{const a=T(t);if(!a)throw new Error("Invalid YouTube URL");await new Promise(I=>setTimeout(I,2e3));const l=`This is a simulated transcript from YouTube video ${a}. In a real implementation, this would fetch the actual transcript using YouTube's API or a transcript extraction service.`;c(l),x("text")}catch{u("Failed to extract transcript. Please check the YouTube URL or try pasting the transcript manually.")}finally{f(!1)}},T=t=>{const a=/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|&v=)([^#&?]*).*/,l=t.match(a);return l&&l[2].length===11?l[2]:null},_=async t=>{if(t.preventDefault(),r==="youtube"){if(!o.trim()||!d.trim()){u("Please provide both a topic and YouTube URL.");return}if(!n.trim()){await y(d);return}}else if(!o.trim()||!n.trim()){u("Please provide both a topic and some source text.");return}u(""),h(!0);try{const a=await S.generateQuiz({transcript:n,num_questions:m}),l={title:o,description:r==="youtube"?`AI-generated quiz from YouTube video on ${o}`:`AI-generated quiz on ${o}`,topic:o,questions:a.length,time:m*2,source_type:r,source_url:r==="youtube"?d:void 0};k(l)}catch(a){console.error(a),u("Failed to generate quiz. The AI service may be unavailable. Please try again later.")}finally{h(!1)}},s=(()=>{switch(z){case"free":return{ai_quizzes:2,youtube_quizzes:2,max_questions:10};case"learner":return{ai_quizzes:10,youtube_quizzes:"unlimited",max_questions:25};case"pro":return{ai_quizzes:"unlimited",youtube_quizzes:"unlimited",max_questions:100};case"pro_plus":return{ai_quizzes:"unlimited",youtube_quizzes:"unlimited",max_questions:"unlimited"};case"admin":return{ai_quizzes:"unlimited",youtube_quizzes:"unlimited",max_questions:"unlimited"};default:return{ai_quizzes:2,youtube_quizzes:2,max_questions:10}}})();return e.jsxs("div",{children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-slate-800 dark:text-slate-100 mb-2",children:"Generate AI Quiz"}),e.jsx("p",{className:"text-slate-600 dark:text-slate-400",children:"Create assessments from YouTube videos or text content using AI"})]}),e.jsxs("form",{onSubmit:_,className:"bg-white dark:bg-slate-800 p-8 rounded-xl shadow-lg shadow-slate-900/5 space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-2 text-slate-600 dark:text-slate-400",children:[e.jsx(v,{className:"w-5 h-5 text-teal-500"}),e.jsx("p",{children:"Let AI create a quiz for you from YouTube videos or text content."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-3",children:"Content Source"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx("button",{type:"button",onClick:()=>x("youtube"),className:`p-4 border-2 rounded-lg transition-colors ${r==="youtube"?"border-red-500 bg-red-50 dark:bg-red-900/20 text-red-700 dark:text-red-300":"border-slate-300 dark:border-slate-600 hover:border-red-300 dark:hover:border-red-500"}`,children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl mb-2",children:"ðŸ“º"}),e.jsx("div",{className:"font-medium",children:"YouTube Video"}),e.jsx("div",{className:"text-xs text-slate-500 dark:text-slate-400 mt-1",children:s.youtube_quizzes==="unlimited"?"Unlimited":`${s.youtube_quizzes} per month`})]})}),e.jsx("button",{type:"button",onClick:()=>x("text"),className:`p-4 border-2 rounded-lg transition-colors ${r==="text"?"border-indigo-500 bg-indigo-50 dark:bg-indigo-900/20 text-indigo-700 dark:text-indigo-300":"border-slate-300 dark:border-slate-600 hover:border-indigo-300 dark:hover:border-indigo-500"}`,children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl mb-2",children:"ðŸ“"}),e.jsx("div",{className:"font-medium",children:"Text Content"}),e.jsx("div",{className:"text-xs text-slate-500 dark:text-slate-400 mt-1",children:s.ai_quizzes==="unlimited"?"Unlimited":`${s.ai_quizzes} per month`})]})})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"topic",className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Quiz Topic"}),e.jsx("input",{type:"text",id:"topic",value:o,onChange:t=>q(t.target.value),required:!0,className:"w-full px-4 py-2 border border-slate-300 dark:border-slate-600 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100",placeholder:"e.g., Introduction to Photosynthesis"})]}),r==="youtube"&&e.jsxs("div",{children:[e.jsx("label",{htmlFor:"youtubeUrl",className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"YouTube Video URL"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"url",id:"youtubeUrl",value:d,onChange:t=>N(t.target.value),required:!0,className:"flex-1 px-4 py-2 border border-slate-300 dark:border-slate-600 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100",placeholder:"https://www.youtube.com/watch?v=..."}),e.jsx("button",{type:"button",onClick:()=>y(d),disabled:!d.trim()||g,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:g?"Extracting...":"Extract"})]}),e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 mt-1",children:"Paste a YouTube video URL and we'll extract the transcript automatically"})]}),r==="text"&&e.jsxs("div",{children:[e.jsx("label",{htmlFor:"sourceText",className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Source Text"}),e.jsx("textarea",{id:"sourceText",value:n,onChange:t=>c(t.target.value),required:!0,rows:8,className:"w-full px-4 py-2 border border-slate-300 dark:border-slate-600 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100",placeholder:"Paste the text content here that you want to generate quiz questions from..."})]}),r==="youtube"&&n&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Extracted Transcript"}),e.jsx("textarea",{value:n,onChange:t=>c(t.target.value),rows:6,className:"w-full px-4 py-2 border border-slate-300 dark:border-slate-600 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100",placeholder:"Transcript will appear here..."}),e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 mt-1",children:"You can edit the transcript before generating the quiz"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"numQuestions",className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Number of Questions"}),e.jsx("input",{type:"number",id:"numQuestions",value:m,onChange:t=>w(Math.min(Number(t.target.value),typeof s.max_questions=="number"?s.max_questions:100)),required:!0,min:"1",max:s.max_questions==="unlimited"?100:s.max_questions,className:"w-full px-4 py-2 border border-slate-300 dark:border-slate-600 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100"}),e.jsxs("p",{className:"text-xs text-slate-500 dark:text-slate-400 mt-1",children:["Maximum ",s.max_questions==="unlimited"?"100":s.max_questions," questions for your tier"]})]}),p&&e.jsx("p",{className:"text-red-500 text-sm -my-2",children:p}),e.jsxs("div",{className:"flex justify-end gap-4 pt-6 border-t border-slate-200 dark:border-slate-700",children:[e.jsx("button",{type:"button",onClick:j,disabled:b,className:"px-6 py-2 rounded-lg bg-slate-200 dark:bg-slate-700 text-slate-800 dark:text-slate-200 font-semibold hover:bg-slate-300 dark:hover:bg-slate-600",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:b,className:"px-6 py-2 rounded-lg bg-teal-600 text-white font-semibold hover:bg-teal-700 flex items-center gap-2 disabled:bg-slate-400 disabled:cursor-wait",children:b?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Generating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(v,{className:"w-5 h-5"}),"Generate Quiz"]})})]})]})]})};export{Q as GenerateAIQuizPage};
